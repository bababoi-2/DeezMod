"use strict";(self.webpackJsonpDeezer=self.webpackJsonpDeezer||[]).push([[7681],{PbG0:(e,r,a)=>{a.d(r,{d6:()=>i,qR:()=>o,Ay:()=>l}),a("/eM8"),a("hB5o"),a("LvTk");var n=a("z+LD"),t=a("bDF2");let o=function(e){return e.Apple="apple",e.Facebook="facebook",e.Form="form",e.Google="google",e.Msisdn="msisdn",e}({}),i=function(e){return e.Link="link",e.Login="login",e.Signup="signup",e.Unlink="unlink",e}({});const _={pushHashedGAUid:async e=>{if(e)try{const r=await((e,r,a="SHA-512")=>{const s=r?r+e:e;return Promise.resolve(window.crypto.subtle.digest(a,(new TextEncoder).encode(s)).then((e=>Array.from(new Uint8Array(e)).map((e=>e.toString(16).padStart(2,"0"))).join(""))))})(e.toString(),"f1r3ba53++//D33z35");(0,t.Fj)({ga_user_id:r||void 0})}catch(e){n.A.error(new Error("Could not hash the userId"))}},pushSuccessfulLoginEvent:(e,r)=>{(0,t.R2)({eventcategory:"login",eventaction:"login-success",eventlabel:e,...r})},pushFailedLoginEvent:(e,r)=>{(0,t.R2)({eventcategory:"login",eventaction:"login-failed",eventlabel:e,...r})},pushFailed3rdPartyConnectEvent:(e,r)=>{switch(r){case i.Login:_.pushFailedLoginEvent(e);break;case i.Signup:_.pushFailedSignupEvent(e);break;case null:case void 0:case i.Link:case i.Unlink:break;default:(0,t.R2)({eventcategory:"third-party-connect",eventaction:"attempt-failed",eventlabel:e})}},pushSuccessfulSignupEvent:(e,r)=>{localStorage.setItem("temporary-register-event","true"),(0,t.R2)({eventcategory:"signup",eventaction:"signup-success",eventlabel:e,...r})},pushFailedSignupEvent:(e,r)=>{(0,t.R2)({eventcategory:"signup",eventaction:"signup-failed",eventlabel:e,...r})}},l=_},p1TQ:(e,r,a)=>{a.d(r,{e7:()=>h,oj:()=>I,Ae:()=>p,V7:()=>O,kL:()=>D,s5:()=>U});var s=a("TqF5"),n=a("PbG0"),t=a("WKgy"),o=a("2+nF"),i=a("DLZI"),_=a("r2u9"),l=a("mwSn"),c=a("CiA5");class E extends l.A{constructor(e){super({errorName:c.$Z.GENERIC_ERROR,logger:!0,...e})}}class A extends E{constructor(e){super({errorMessage:"connect_status_unknown",analytics:{message:"unkown connect status sent by backend",...null==e?void 0:e.analytics},...e||{}})}}var d=a("rVxF"),u=a("WrS5"),R=a("H/eQ"),L=a("nrKQ"),g=a("Vd8Q");const p=e=>{let{link:r=""}=e||{};const{type:a="page"}=e||{};return"/"===r.charAt(0)||/^https?/.test(r)||(r="/"+r),{type:a,link:r}},I=(e,r)=>{const a=null==e?void 0:e.status;let{redirect:i}=r;try{t.A.dispatch((0,s.Oo)())}catch{}switch(a){case"success":n.Ay.pushSuccessfulLoginEvent(r.method),(0,o.Qc)(i);break;case"register":{const e=(()=>{if(/pay_register/g.test(location.href)){const e=location.href.indexOf("redirect_link");return location.href.substr(e,location.href.length).replace("redirect_link=","")}return null})();e&&(i=p({type:"page",link:decodeURIComponent(e)})),n.Ay.pushSuccessfulSignupEvent(r.method),(0,o.Qc)(i);break}default:throw new A}},O=(e,r=!1)=>{e&&r?t.A.dispatch((0,s.qf)({size:"small",name:u.b.PROFILE_MIGRATION_CONFIRMED,disableClosingAction:!0})):e&&(null===_.Ay||void 0===_.Ay||_.Ay.reloadApp(),location.reload())},U=e=>{e&&(null===_.Ay||void 0===_.Ay||_.Ay.reloadApp(),location.reload())},D=(e,r)=>{(e instanceof l.A||e instanceof d.A)&&e.handleError(r)},N=new i.A({call:L.A.callAsync.bind(L.A)},"production"),h=e=>(N.init(e,g.default.get("third_party_sdk_config")).then((()=>{switch(e){case"apple":R.A.resolve(R.A.apple.ready);break;case"facebook":R.A.resolve(R.A.facebook.ready);break;case"google":R.A.resolve(R.A.googleplus.ready);break;default:return}})),N)},rVxF:(e,r,a)=>{a.d(r,{A:()=>T,O:()=>y});var s=a("WrS5"),n=a("5U+Y"),t=a("Wp0Y"),o=a("CiA5");const i={[o.U5.DEFAULT]:()=>(0,t.AP)("errormessage_text_anerroroccurredpleasetryagain_web"),[o.U5.COUNTRY_NOT_VALID]:()=>(0,t.AP)("errormessage_text_signupunavailableinyourcountry_web"),[o.U5.COUNTRY_CLOSED_FREEMIUM]:()=>(0,t.AP)("errormessage_text_deezerunavailableinyourcountry_web"),[o.U5.MIN_LEGAL_AGE]:e=>(0,t.WI)("agerestrictionerrormessage_text_mustbeXyearsentervaliddate_web","agerestrictionerrormessage_text_mustbeXyearsentervaliddate_web",e||{sprintf:[n.fB],count:n.fB}),[o.U5.SOCIAL_ALREADY_CONNECTED]:e=>(0,t.AP)("errormessage_text_accountalreadylinkedwiththisXsocial_web",e),[o.U5.USER_ALREADY_LINKED]:e=>(0,t.AP)("errormessage_text_accountalreadylinkedwithaXsocial_web",e),[o.U5.EMAIL_ALREADY_USED_TITLE]:()=>(0,t.AP)("errormessage_title_accountalrdyassociatedwithemail_web"),[o.U5.EMAIL_ALREADY_USED_WITH_INSTANT_AUTH_BODY]:e=>(0,t.AP)("signinloginerrormessage_text_uselinksenttoXemailortryanother_web",e),[o.U5.EMAIL_ALREADY_USED_BODY]:e=>(0,t.AP)("errormessage_text_loginlnkXaccountfrmdzrsettings_web",e)},_=(e,r)=>i[e](r);var l=a("mwSn"),c=a("WKgy"),E=a("TqF5");class DataError extends l.A{constructor(e){super({modal:{data:{name:s.b.GENERIC_ERROR,props:{errorMessage:_(o.U5.DEFAULT)}}},analytics:{message:e.errorMessage},...e,errorName:o.$Z.DATA_ERROR})}}class A extends DataError{constructor(e){super({errorMessage:o.U1.SOCIAL_ALREADY_CONNECTED,...e})}_handleModal(e,r){c.A.dispatch((0,E.UJ)({name:s.b.GENERIC_ERROR,props:{errorMessage:_(o.U5.SOCIAL_ALREADY_CONNECTED,{sprintf:[r.method]})}}))}}class d extends DataError{constructor(e){super({errorMessage:o.U1.EMAIL_ALREADY_USED,...e})}_handleModal(e,r){c.A.dispatch((0,E.UJ)({name:s.b.GENERIC_ERROR,props:{title:_(o.U5.EMAIL_ALREADY_USED_TITLE),errorMessage:_(o.U5.EMAIL_ALREADY_USED_BODY,{sprintf:[r.method]})}}))}}class u extends DataError{constructor(e,r){super({errorMessage:o.U1.EMAIL_ALREADY_USED,modal:{data:{name:s.b.GENERIC_ERROR,props:{errorMessage:_(o.U5.EMAIL_ALREADY_USED_WITH_INSTANT_AUTH_BODY,{sprintf:[r]}),title:_(o.U5.EMAIL_ALREADY_USED_TITLE)}}},...e})}}class R extends DataError{constructor(e){super({errorMessage:o.U1.USER_NOT_LINKED,...e})}}class L extends DataError{constructor(e){super({errorMessage:o.U1.USER_ALREADY_LINKED,modal:{data:{name:s.b.GENERIC_ERROR}},...e})}_handleModal(e,r){c.A.dispatch((0,E.UJ)({name:s.b.GENERIC_ERROR,props:{errorMessage:_(o.U5.USER_ALREADY_LINKED,{sprintf:[r.method]})}}))}}class g extends DataError{constructor(e){super({errorMessage:o.U1.USER_USING_APPLE_EMAIL,...e})}}class p extends l.A{constructor(e){super({analytics:{message:e.errorMessage},modal:{data:{name:s.b.GENERIC_ERROR,props:{errorMessage:_(o.U5.DEFAULT)}}},errorName:o.$Z.REQUEST_ERROR,...e})}}class I extends p{constructor(e){super({errorMessage:o.nu.COUNTRY_NOT_VALID,modal:{data:{name:s.b.GENERIC_ERROR,props:{errorMessage:_(o.U5.COUNTRY_NOT_VALID)}}},...e})}}class O extends p{constructor(e){super({errorMessage:o.nu.INVALID_ACCOUNT_TYPE,...e})}}class U extends p{constructor(e){super({errorMessage:o.nu.MIN_LEGAL_AGE,modal:{data:{name:s.b.GENERIC_ERROR,props:{errorMessage:_(o.U5.MIN_LEGAL_AGE)}}},...e})}}class D extends p{constructor(e){super({errorMessage:o.nu.BIRTHDAY_NOT_VALID,...e})}}class N extends p{constructor(e){super({errorMessage:o.nu.MISSING_INFO,modal:{data:{name:s.b.MISSING_INFO_JOURNEY,props:{steps:e.steps}},isFull:!0},...e})}}class h extends l.A{constructor(e){super({analytics:{message:o.$Z.COUNTRY_CLOSED_FREEMIUM},modal:{data:{name:s.b.GENERIC_ERROR,props:{errorMessage:_(o.U5.COUNTRY_CLOSED_FREEMIUM)}}},...e,errorName:o.$Z.COUNTRY_CLOSED_FREEMIUM})}}const m=e=>{switch(e.errorName){case o.$Z.DATA_ERROR:return(e=>{var r;switch(e.errorMessage){case o.U1.EMAIL_ALREADY_USED:var a;return null!==(r=e.payload)&&void 0!==r&&r.INSTANT_AUTH?new u(e,null===(a=e.payload)||void 0===a?void 0:a.email):new d(e);case o.U1.USER_ALREADY_LINKED:return new L(e);case o.U1.USER_NOT_LINKED:return new R(e);case o.U1.USER_USING_APPLE_EMAIL:return new g(e);default:return-1!==e.errorMessage.indexOf(o.U1.SOCIAL_ALREADY_CONNECTED)?new A(e):new DataError(e)}})(e);case o.$Z.REQUEST_ERROR:return(e=>{switch(e.errorMessage){case o.nu.COUNTRY_NOT_VALID:return new I(e);case o.nu.INVALID_ACCOUNT_TYPE:return new O(e);case o.nu.MIN_LEGAL_AGE:return new U(e);case o.nu.BIRTHDAY_NOT_VALID:return new D(e);case o.nu.MISSING_EMAIL:case o.nu.EMAIL_EMPTY:case o.nu.EMAIL_NOT_VALID:case o.nu.EMAIL_DOMAIN_NOT_VALID:return new N({...e,steps:["email"]});case o.nu.MISSING_INFO:{var r;const a=null===(r=e.payload)||void 0===r?void 0:r.required_info;return new N({...e,steps:a})}default:return new p(e)}})(e);case o.$Z.COUNTRY_CLOSED_FREEMIUM:return(e=>new h(e))(e);default:return new l.A({logger:!0,modal:{data:{name:s.b.GENERIC_ERROR,props:{errorMessage:_(o.U5.DEFAULT)}}},...e})}},y=e=>e.name&&e.message&&typeof e.payload;class T extends Error{constructor(e){super("API Error"),this.payload=void 0,this.payload=e}handleError(e){try{Object.entries(this.payload.response.error).forEach((([r,a])=>{m({errorName:r,errorMessage:a,payload:this.payload.response.payload}).handleError(e)}))}catch{m({errorName:o.$Z.DEFAULT,errorMessage:""}).handleError(e)}}}},mwSn:(e,r,a)=>{a.d(r,{A:()=>i});var s=a("z+LD"),n=a("PbG0"),t=a("TqF5"),o=a("WKgy");class i extends Error{constructor(e){super(),this.analytics=void 0,this.logger=void 0,this.modal=void 0,this.analytics=e.analytics,this.logger=e.logger,this.message=e.errorMessage,this.modal=e.modal,this.name=e.errorName}handleError(e){this.logger&&this._handleLogger(),this.analytics&&this._handleAnalytics(this.analytics,e),this.modal&&this._handleModal(this.modal,e)}_handleAnalytics(e,r){n.Ay.pushFailed3rdPartyConnectEvent(`${r.method} - ${e.message}`||"",r.intent)}_handleLogger(){s.A.error(this)}_handleModal(e,r){const a={size:"small",...e.data,props:{...e.data.props,...r}};o.A.dispatch((0,t.UJ)(a,e.isFull))}}},CiA5:(e,r,a)=>{a.d(r,{$Z:()=>s,U1:()=>n,U5:()=>o,nu:()=>t});let s=function(e){return e.APPLE_ERROR="APPLE_ERROR",e.COUNTRY_CLOSED_FREEMIUM="COUNTRY_CLOSED_FREEMIUM",e.DATA_ERROR="DATA_ERROR",e.DEFAULT="DEFAULT",e.FACEBOOK_ERROR="FACEBOOK_ERROR",e.GOOGLE_ERROR="GOOGLE_ERROR",e.GENERIC_ERROR="GENERIC_ERROR",e.REQUEST_ERROR="REQUEST_ERROR",e}({}),n=function(e){return e.EMAIL_ALREADY_USED="email_already_used",e.SOCIAL_ALREADY_CONNECTED="id_already_linked",e.USER_ALREADY_LINKED="user_already_linked",e.USER_NOT_LINKED="user_not_linked",e.USER_USING_APPLE_EMAIL="user_using_apple_email",e}({}),t=function(e){return e.BIRTHDAY_NOT_VALID="birthday_not_valid",e.COUNTRY_NOT_VALID="country_not_valid",e.EMAIL_DOMAIN_NOT_VALID="email_domain_not_valid",e.EMAIL_EMPTY="email_empty",e.EMAIL_NOT_VALID="email_not_valid",e.INVALID_ACCOUNT_TYPE="invalid_account_type",e.MIN_LEGAL_AGE="min_legal_age",e.MISSING_EMAIL="missing_email",e.MISSING_INFO="missing_info",e}({}),o=function(e){return e[e.COUNTRY_CLOSED_FREEMIUM=0]="COUNTRY_CLOSED_FREEMIUM",e[e.COUNTRY_NOT_VALID=1]="COUNTRY_NOT_VALID",e[e.DEFAULT=2]="DEFAULT",e[e.EMAIL_ALREADY_USED_BODY=3]="EMAIL_ALREADY_USED_BODY",e[e.EMAIL_ALREADY_USED_WITH_INSTANT_AUTH_BODY=4]="EMAIL_ALREADY_USED_WITH_INSTANT_AUTH_BODY",e[e.EMAIL_ALREADY_USED_TITLE=5]="EMAIL_ALREADY_USED_TITLE",e[e.MIN_LEGAL_AGE=6]="MIN_LEGAL_AGE",e[e.SOCIAL_ALREADY_CONNECTED=7]="SOCIAL_ALREADY_CONNECTED",e[e.USER_ALREADY_LINKED=8]="USER_ALREADY_LINKED",e}({})},exUT:(e,r,a)=>{a.d(r,{A:()=>L}),a("/eM8");var s=a("PbG0"),n=a("WLHJ");const t=e=>({method:n.K.FACEBOOK,...e});var o=a("TqF5"),i=a("WKgy"),_=a("p1TQ"),l=a("WrS5"),c=a("rVxF"),E=a("dgkV"),A=a("IZLt");const d=(0,_.e7)("facebook"),u=()=>{if(!d.facebook)throw new Error("LegacyAuth - Facebook not found, have you called init with facebook as a param?");return d.facebook},R=()=>{u().signout()},L={linkAccount:async e=>{try{const r=await u().linkAccount(e);(0,_.V7)(r,null==e?void 0:e.profile_migration)}catch(a){R();const n=t({intent:s.d6.Link});var r;if(a instanceof Error)new A.A({error:null!==(r=a.message)&&void 0!==r?r:a.name,journey_type:null!=e&&e.profile_migration?"family-convert-independent":"link-facebook",gateway_method:"facebook.linkAccount",server_payload:a}).send(),(0,_.kL)(a,n)}},login:async(e,r)=>{try{const r=await u().signin(e);(0,_.oj)(r,{redirect:(0,_.Ae)(null==e?void 0:e.redirect),method:s.qR.Facebook})}catch(o){const i=t({intent:s.d6.Login,redirect:null==e?void 0:e.redirect});var a,n;if((0,c.O)(o))new E.A({error:null!==(a=o.message)&&void 0!==a?a:null===(n=o.payload)||void 0===n?void 0:n.status,journey_type:"facebook",error_message:o.message,gateway_method:"facebook.auth"}).send(),(0,_.kL)(new c.A(o),i);null==r||r(o)}},signout:R,signup:async(e,r)=>{try{const r=await u().signin(e);(0,_.oj)(r,{redirect:(0,_.Ae)(null==e?void 0:e.redirect),method:s.qR.Facebook})}catch(o){const i=t({intent:s.d6.Signup,redirect:null==e?void 0:e.redirect});var a,n;if((0,c.O)(o))new E.A({error:null!==(a=null===(n=o.payload)||void 0===n?void 0:n.status)&&void 0!==a?a:o.name,journey_type:"facebook",error_message:o.message,gateway_method:"facebook.auth"}).send(),(0,_.kL)(new c.A(o),i);null==r||r(o)}},unlinkAccount:()=>{i.A.dispatch((0,o.qf)({name:l.b.THIRD_PARTY_CONFIRM_UNLINK,size:"small",props:{method:"Facebook",confirmCallback:()=>(async()=>{try{const e=await u().unlinkAccount();(0,_.s5)(e)}catch(r){const a=t({intent:s.d6.Unlink});var e;(0,c.O)(r)&&(new A.A({error:null!==(e=r.message)&&void 0!==e?e:r.name,journey_type:"unlink-facebook",gateway_method:"facebook.unlinkAccount",server_payload:r}).send(),(0,_.kL)(new c.A(r),a))}})()}}))}}},WLHJ:(e,r,a)=>{a.d(r,{K:()=>s});let s=function(e){return e.APPLE="Apple",e.FACEBOOK="Facebook",e.GOOGLE="Google",e}({})},"5U+Y":(e,r,a)=>{a.d(r,{D3:()=>_,D6:()=>t,K9:()=>n,d0:()=>o,fB:()=>i,wz:()=>s});const s=8,n=50,t=2,o=50,i=16,_=150},dgkV:(e,r,a)=>{a.d(r,{A:()=>i});var s=a("LOQS"),n=a("ebSJ"),t=a("Sw64"),o=a("WKgy");const i=class{constructor(e){var r,a;this._log=void 0,this._log={device_uniq_id:(0,n.A)("dzr_uniq_id"),error_extra:"legacy",...(null===(r=o.A.getState())||void 0===r||null===(r=r.user)||void 0===r?void 0:r.COUNTRY)&&{country:null===(a=o.A.getState())||void 0===a||null===(a=a.user)||void 0===a?void 0:a.COUNTRY},...e}}send(){this._log={...this._log},s.A.log((0,t.L)("user.auth_vitals","1.0.0",this._log))}}},"2+nF":(e,r,a)=>{a.d(r,{Cb:()=>t,Qc:()=>n}),a("EV0h"),a("gS5K"),a("iooo"),a("/0Gg"),a("vXsw"),a("nrKQ"),a("Vd8Q");var s=a("r2u9");const n=e=>{null===s.Ay||void 0===s.Ay||s.Ay.reloadApp()},t=()=>{null===s.Ay||void 0===s.Ay||s.Ay.reloadApp()}}}]);