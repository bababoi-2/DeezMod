"use strict";(self.webpackJsonpDeezer=self.webpackJsonpDeezer||[]).push([[8805],{nenF:(e,t,a)=>{a.r(t),a.d(t,{trackMemoryUsage:()=>d}),a("WpbS");var i=a("H/eQ"),s=a("LOQS"),r=a("Sw64");const n=class{constructor({id:e,value:t=0,tags:a}){this._log=void 0,this._id=void 0,this._value=void 0,this._id=e,this._value=t,this._log={metric:{id:this._id},gauge:this._value},a&&Object.keys(a).length&&(this._log.metric.tags=a)}get id(){return this._id}get value(){return this._value}set value(e){this._value=e}_reset(){this._value=0}send(){this._log={...this._log,gauge:this.value},s.A.log((0,r.L)("metrics.gauge","1.0.0",this._log)),this._reset()}};var o=a("+pY+");function l(e,t,a){return a.reduce(((a,i)=>""!==a?a:e<i?`< ${i}${t}`:""),"")||`${a[a.length-1]}${t} +`}function m(e){return l(e/36e5,"h",[1,3,5,10])}function u(e){return l(e/1024/1024,"MB",[50,100,300,500,1e3])}const d=function(e,t){if(!("memory"in performance))return()=>{};const a={playStarted:void 0,appStarted:Date.now()},s={listeningTime:0,nbNavigations:0,maxUsedMemory:0},r=history.pushState.bind(history);history.pushState=(...e)=>(s.nbNavigations++,r(...e));const d=setInterval((()=>{s.maxUsedMemory=Math.max(s.maxUsedMemory,performance.memory.usedJSHeapSize)}),5e3);i.A.subscribe(i.A.player.playing,((e,t)=>{t?a.playStarted=Date.now():(s.listeningTime+=a.playStarted?Date.now()-a.playStarted:0,a.playStarted=void 0)}),"memoryStats");const g=()=>{const e=function(e,t,a,i){a.listeningTime+=t.playStarted?Date.now()-t.playStarted:0;const s=Date.now()-t.appStarted;return{memoryLoad:e.usedJSHeapSize/e.jsHeapSizeLimit,memoryUsage:e.usedJSHeapSize,tags:{listeningTime:m(a.listeningTime),maxUsedMemory:u(a.maxUsedMemory),nbNavigation:(r=a.nbNavigations,l(r,"",[5,10,50,100])),appUptime:m(s),memoryLimit:u(e.jsHeapSizeLimit),audioQuality:i()}};var r}(performance.memory,a,s,t);!function(e){const t=new n({id:o.eN.MEMORY_USAGE,value:e.memoryUsage,tags:e.tags}),a=new n({id:o.eN.MEMORY_LOAD,value:e.memoryLoad,tags:e.tags});t.send(),a.send()}(e),a.playStarted=a.playStarted?Date.now():void 0},p=setInterval(g,e);return g(),function(){clearInterval(d),clearInterval(p),i.A.unsubscribeAll("memoryStats"),history.pushState=r}}}}]);