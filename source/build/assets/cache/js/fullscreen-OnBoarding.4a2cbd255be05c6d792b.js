"use strict";(self.webpackJsonpDeezer=self.webpackJsonpDeezer||[]).push([[5986],{"YG/N":(e,t,r)=>{r.d(t,{A:()=>p});var s=r("WKgy"),i=r("q1tI"),a=r("juqV");var o=r("TRpf"),l=r("5Kqk"),c=r("nxAS");const d=(0,o.Ng)(null,{closeScreen:c.Fn})((({customClose:e,closeScreen:t})=>{const r=e||t;return i.createElement(l.J,{position:"absolute",top:"8px",right:"8px",size:"lg",onClick:r,zIndex:2})}));s.A.addReducers({modal:c.Ay});const p={Body:({className:e,children:t})=>{const r=(0,a.A)("full-screen-body",e);return i.createElement("div",{className:r},t)},Close:d,Footer:({className:e,children:t})=>{const r=(0,a.A)("full-screen-footer",e);return i.createElement("div",{className:r},t)},Header:({className:e,children:t})=>{const r=(0,a.A)("full-screen-header",e);return i.createElement("h1",{className:r},t)}}},"5s/P":(e,t,r)=>{r.r(t),r.d(t,{default:()=>Ae});var s,i=r("q1tI"),a=r("X6oL"),n=r("TRpf"),o=r("Wp0Y"),l=r("WmA5"),c=r("hz5U"),d=r("YG/N"),h=r("aHAS"),m=r("e2eG");const p=(0,a.Ay)({pagename:"onboarding",pagecategory:"onboarding-artists",virtualpageurl:"/onboarding-completed",event:"virtualpageview"},{dispatchOnMount:!0})((({closeScreen:e,callbackLink:t})=>{const r=(0,n.wA)();return i.useEffect((()=>{r((0,h.Sk)((()=>{m.A.init(),l.A.replace(t),e()})))}),[]),i.createElement("div",{className:"onboarding-screen-finish"},i.createElement(d.A.Header,{className:"onboarding-screen-finish-header"},(0,o.AP)("Splendide !")),i.createElement("div",{key:"onboarding-screen-finish-animation",className:"onboarding-screen-finish-animation"},s||(s=i.createElement("div",{className:"onboarding-screen-finish-loader"})),i.createElement("img",{className:"onboarding-screen-finish-loader-picture",width:"204",src:c.A.getImageSrc("misc","4d557016ec84834d42fbea9c97d3b4eb",204,204,"none")})))}));var u=r("+9dH"),f=(r("/eM8"),r("RGaU")),g=r("HmE0"),E=r("NSet"),A=r("nrKQ");const v=(e,t)=>e.map((e=>({id:e.ART_ID,name:e.ART_NAME,image:e.ART_PICTURE||{format:"jpg",type:"artist",md5:"d41d8cd98f00b204e9800998ecf8427e"},isSelected:!1,reference:t}))),S=e=>e.id,x=(e,t,r)=>{A.A.call({method:"onboarding.getTopArtists",data:{CONTEXT:e},success:e=>{t(v(e))},error:r})};var b=r("5G9X"),y=r("LjZa"),_=r("34sk"),w=r("xobL"),k=r("kSUS"),C=r("3o0m"),L=r("Z9kq"),O=r("ntT5"),I=r("rXlm"),B=r("MG7B");const F=({artist:e,onClick:t})=>i.createElement("div",{className:"onboarding-screen-search-item",onClick:t},i.createElement("img",{className:"onboarding-screen-search-item-picture",src:c.A.getImageSrc("artist",e.image.md5,55,55)}),i.createElement("div",{className:"onboarding-screen-search-item-name ellipsis"},e.name));var T,P=r("4liH"),R=r("7E8A");class G extends i.Component{constructor(...e){super(...e),this.state={isOpened:!1,searchResult:[],query:"",searchResultLoaded:!1},this.textInput=i.createRef(),this.popoverElement=i.createRef(),this.focusInput=()=>{this.textInput.current&&this.textInput.current.focus()},this.searchArtist=(0,k.A)((()=>{var e,t,r,s;this.state.query&&(e=this.state.query,t=this.props.context,r=this.setSearchResult,s=y.A,A.A.call({method:"onboarding.searchArtist",data:{QUERY:e,CONTEXT:t},success:e=>{r(v(e.data))},error:s}))}),500),this.setSearchResult=e=>{this.setState({searchResult:e,searchResultLoaded:!0,isOpened:!0})},this.clickOutsideSearch=e=>{const t=e.target;null===this.textInput.current||this.textInput.current.contains(t)||this.closePopper()},this.closePopper=()=>{this.props.onPopoverOpened(!1),this.setState({isOpened:!1})},this.onArtistSelection=e=>{(0,O.Fw)(this.state.query,"",R.CONTEXT_PAGE_SEARCH_ONBOARDING,P.SA,{...e,type:b.Ay.Artist}),this.closePopper(),this.props.onArtistSelection(e),this.setState({query:"",searchResult:[],isOpened:!1,searchResultLoaded:!1})},this.onInputChange=e=>{const t=Boolean(e.target.value);this.setState({isOpened:t,query:e.target.value,searchResultLoaded:!1}),this.props.onPopoverOpened(t),t||this.closePopper(),this.searchArtist()},this.onWrapperClick=()=>{this.focusInput(),this.props.onPopoverOpened(this.state.searchResultLoaded),this.setState({isOpened:this.state.searchResultLoaded})},this.onCancelClick=()=>{this.props.onPopoverOpened(!1),this.setState({query:"",searchResult:[],isOpened:!1,searchResultLoaded:!1})}}componentDidMount(){document.addEventListener("click",this.clickOutsideSearch)}get resultList(){if(!this.state.searchResultLoaded)return T||(T=i.createElement(f.k,null));if(!this.state.searchResult.length){const e=(0,o.AP)("Aucun résultat pour «<strong>%s</strong>»",{sprintf:[" "+(0,B.A)(this.state.query)+" "]});return i.createElement("div",{className:"onboarding-screen-search-no-results",dangerouslySetInnerHTML:{__html:e}})}return i.createElement(I.A,{className:"onboarding-screen-search-list"},this.state.searchResult.map((e=>i.createElement(F,{key:e.id,artist:e,onClick:this.onArtistSelection.bind(this,e)}))))}render(){return i.createElement(E.so,{w:"100%"},i.createElement(L.D,{ref:this.textInput,id:"onBoardingSearchAnchor",className:"onboarding-screen-search-input",type:"text",autoComplete:"off",placeholder:(0,o.AP)("Rechercher"),onChange:this.onInputChange,value:this.state.query,onClick:this.onWrapperClick}),this.state.isOpened&&i.createElement(C.A,{anchorNode:this.textInput.current,className:"onboarding-screen-search-popper"},this.resultList))}}var N=r("juqV"),M=r("koXx"),U=r("NmXx"),D=r("//u0");const z=242;class X extends i.Component{constructor(...e){super(...e),this.self=i.createRef(),this.onClick=()=>{this.props.onClick(this.props.id,this.self.current)}}get imageUrl(){const{image:{type:e,md5:t}}=this.props;return c.A.getImageSrc(e,t,z,z)}render(){const e=(0,N.A)("onboarding-screen-artist-item",{"onboarding-screen-artist-item--selected":this.props.isSelected});return i.createElement("div",{ref:this.self,className:e,onClick:this.onClick},i.createElement(U.P.div,{layout:!0,transition:{duration:.2}},i.createElement(U.P.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.2,delay:.1}},i.createElement("div",{className:"onboarding-screen-artist-item-image-wrapper"},i.createElement(M._V,{className:"onboarding-screen-artist-item-image",loading:"lazy",src:this.imageUrl,htmlWidth:z,htmlHeight:z}),i.createElement(D.C,{sx:{color:"#FEFEFE",position:"absolute",top:"calc(50% - 25px)",left:"calc(50% - 18px)",boxSize:8,opacity:this.props.isSelected?1:0,transition:"opacity 0.5s ease"}})),i.createElement("div",{className:"onboarding-screen-artist-item-name ellipsis"},this.props.name))))}}const W=X;var j;const q=e=>{const[t,r]=(0,i.useState)(!1);if((0,i.useEffect)((()=>{const e=setTimeout((()=>{r(!0)}),250);return()=>clearTimeout(e)}),[]),!t)return j||(j=i.createElement(E.ov,null,i.createElement(f.k,null)));const s=e.artists.map((t=>i.createElement(W,(0,u.A)({key:t.id,onClick:e.toggleArtistSelection},t))));return i.createElement(E.az,{className:"onboarding-screen-grid-wrapper",w:"100%"},i.createElement(I.A,{className:"onboarding-screen-grid-scroller"},i.createElement(E.az,{className:"onboarding-screen-grid"},s)))};var Z=r("kD7r");const H=({onSelected:e,context:t})=>{const[r,s]=(0,i.useState)([]),[a,n]=(0,i.useState)();(0,i.useEffect)((()=>{((e,t,r)=>{A.A.call({method:"onboarding.getTopGenres",data:{CONTEXT:e},success:e=>{(e=>{s(e.map((e=>({...e,isSelected:!1}))))})(e.map((e=>({id:e.GENRE_ID,name:e.GENRE_NAME}))))},error:r})})(t,0,y.A)}),[]);const o=(0,Z.dU)("gray","white");return i.createElement(E.BJ,{direction:"row",spacing:3,align:"center",w:"fit-content",py:"4px"},r.map((t=>{const r=t.id===(null==a?void 0:a.id);return i.createElement(g.$n,{key:t.id,variant:r?"solid":"outline",onClick:()=>(t=>{const r=a&&a.id===t.id?void 0:t;n(r),e(r)})(t),size:"sm",colorScheme:r?o:"gray",fontWeight:"normal"},t.name)})))};var V,J,Y=r("I36q"),K=r("A2sV"),Q=r("g1Fm"),$={name:"y0dhib",styles:"&::-webkit-scrollbar{display:none;}scrollbar-width:none"};let ee=(0,a.Ay)({pagename:"onboarding",pagecategory:"onboarding-artists",virtualpageurl:"/onboarding-artists",event:"virtualpageview"},{dispatchOnMount:!0})(V=class extends i.Component{constructor(...e){super(...e),this.state={artistList:[],artistListLoaded:!1,finalizing:!1,searchDisplay:!0,popoverOpened:!1},this.currentGetRelatedCall=void 0,this.selectedArtists={},this.mainListSnapShot=[],this.selectedGenre=void 0,this.addArtistAtTopOfList=e=>{const t=this.state.artistList.filter((t=>e.id!==t.id));this.setState({artistList:this.rebuildArtistList([e,...t])})},this.addRelatedArtistsToList=(e,t)=>{const r=[...this.state.artistList],s=r.findIndex((t=>e.id===t.id))+1;r.splice(s,0,...t),this.setState({artistList:this.rebuildArtistList(r)})},this.toggleArtist=(e,t)=>{if(this.selectedArtists[e])delete this.selectedArtists[e];else{if(!this._maxArtistSelectionSafeGuard())return;this.selectedArtists[e]=!0}const r=this.rebuildArtistList(this.state.artistList);this.setState({artistList:r});const s=r.find((t=>t.id===e&&t.isSelected));s&&this.getRelatedArtistsAndAddTolist({...s,reference:t})},this.onGenreSelected=e=>{this.setState({artistListLoaded:!1},(()=>{if(e)void 0===this.selectedGenre&&(this.mainListSnapShot=this.state.artistList),this.selectedGenre=e,t=e.id,r=this.props.context,s=e=>this.setState({artistList:this.rebuildArtistList(e),artistListLoaded:!0}),i=y.A,A.A.call({method:"onboarding.getTopArtistsByGenre",data:{GENRE_ID:t,CONTEXT:r},success:e=>{s(v(e))},error:i});else{if(this.selectedGenre=void 0,this.mainListSnapShot)return void this.setState({artistList:this.rebuildArtistList(this.mainListSnapShot),artistListLoaded:!0});x(this.props.context,(e=>this.setState({artistList:this.rebuildArtistList(e),artistListLoaded:!0})),y.A)}var t,r,s,i}))},this.getRelatedArtistsAndAddTolist=e=>{var t,r,s,i,a,n;this.currentGetRelatedCall=(t=e,r=this.state.artistList,s=this.props.context,i=this.addRelatedArtistsToList,a=y.A,(n=this.currentGetRelatedCall)&&A.A.cancel(n),A.A.call({method:"onboarding.getRelatedArtists",data:{ART_ID:t.id,CONTEXT:s,EXCLUDED_ARTISTS:r.map(S)},success:e=>{i(t,v(e,t.reference))},error:a}))},this.onCompleted=()=>{var e;this.setState({finalizing:!0});const{context:t,isOnlyAddArtist:r}=this.props;if(null===(e=this.props.tracking)||void 0===e||e.trackEvent({eventname:"click",eventcategory:"onboarding-artists",eventaction:"validate"}),t===Y.d.Improve){const e=(0,w.mI)({SERVER_TIMESTAMP:this.props.serverTimestamp,clientTimestampDelta:this.props.clientTimestampDelta});this.props.addMultipleFavoritesAction(this.selectedArtistList,b.Ay.Artist,e,{},!1).then((()=>{this.props.addArtistsFavorites(this.selectedArtistList)})).then(this.props.finishStep)}r||this.props.validateOnboardingArtistsPickerStep(this.selectedArtistList).then(this.props.finishStep)},this.onSearchSelected=e=>{this._maxArtistSelectionSafeGuard()&&(this.selectedArtists[e.id]=!0,this.mainListSnapShot=[e,...this.mainListSnapShot.filter((t=>t.id!==e.id))],this.addArtistAtTopOfList({...e,isSelected:!0}),this.getRelatedArtistsAndAddTolist(e))},this.onPopoverOpened=e=>{this.setState({popoverOpened:e})}}componentDidMount(){x(this.props.context,(e=>this.setState({artistList:e,artistListLoaded:!0})),y.A)}get selectedArtistList(){return Object.keys(this.selectedArtists)}get artistGrid(){return this.state.artistListLoaded?i.createElement(q,{artists:this.state.artistList,toggleArtistSelection:this.toggleArtist}):J||(J=i.createElement("div",{className:"onboarding-screen-artists-loader"},i.createElement(f.k,null)))}get isSelectionCompleted(){return this.selectedArtistList.length>=this.props.minArtistsToSelect}get nextButton(){let e,t=!0;const r=this.selectedArtistList.length;return 0===this.props.minArtistsToSelect?(e=(0,Q.A)((0,o.AP)("TERMINER"),!0),t=!1):r?r<this.props.minArtistsToSelect?e=(0,o.WI)("artistselectionoptimization_action_chooseXmoreartistsUPP_web","artistselectionoptimization_action_chooseXmoreartistsUPP_web",{sprintf:[this.props.minArtistsToSelect-r],count:this.props.minArtistsToSelect-r}):(e=(0,o.WI)("artistselectionoptimization_action_continuewithXartistsUPP_web","artistselectionoptimization_action_continuewithXartistsUPP_web",{sprintf:[r],count:r}),t=!1):e=(0,o.WI)("artistselectionoptimization_action_chooseatleastXartistsUPP_web","artistselectionoptimization_action_chooseatleastXartistsUPP_web",{sprintf:[this.props.minArtistsToSelect],count:this.props.minArtistsToSelect}),i.createElement(g.$n,{isDisabled:t,onClick:this.onCompleted},e)}showMaxAlert(){alert((0,o.AP)("errormessage_title_maximumreached_web")+"\n"+(0,o.AP)("errormessage_text_maxnberartistreachedforthisstage_web")+"\n"+(0,o.AP)("errormessage_text_dontworrycanaddmorelater_web"))}rebuildArtistList(e){return e.map((e=>({...e,isSelected:Boolean(this.selectedArtists[e.id])})))}_maxArtistSelectionSafeGuard(){return!(this.selectedArtistList.length>=this.props.maxArtistsToSelect&&(this.showMaxAlert(),1))}render(){const e=Y.d.Welcome;return i.createElement(i.Fragment,null,this.props.showCloseButton?i.createElement(d.A.Close,{customClose:this.props.closeScreen}):null,i.createElement(E.BJ,{direction:"column",spacing:"6",h:"100vh",w:"100vw",position:"absolute",top:"0",left:"0",px:"4",py:"6"},i.createElement(E.so,{w:"100%",alignItems:"center",justifyContent:"center"},i.createElement(E.mc,{maxW:"800px"},i.createElement(E.BJ,{direction:"column",spacing:"4",textAlign:"center"},i.createElement(E.DZ,{as:"h1",fontSize:"30px",className:"onboarding-screen-artists-header"},e?(0,o.AP)("Bienvenue"):(0,Q.A)((0,o.AP)("artistselectionoptimization_action_chooseartistUPP_web"))),i.createElement(E.EY,{fontSize:"14px"},e?(0,o.AP)("artistselectionoptimization_text_chooseartistsformorepersonalizedreco_web"):(0,o.AP)("onboardingartistpicker_text_improverecoselectfavartists_web")),i.createElement(G,{onArtistSelection:this.onSearchSelected,onPopoverOpened:this.onPopoverOpened,context:this.props.context})))),i.createElement(E.so,{w:"100%",alignItems:"center",justifyContent:{base:"flex-start",md:"center"},overflow:"auto",css:$},this.props.showGenreFilter&&i.createElement(H,{onSelected:this.onGenreSelected.bind(this),context:this.props.context})),i.createElement(E.az,{w:"100%",id:"artist-grid",flex:"1"},i.createElement(E.mc,{maxW:"1400px",display:"flex",alignItems:"center",justifyContent:"center",h:"100%"},this.artistGrid)),i.createElement(E.so,{w:"100%",alignItems:"center",justifyContent:"center"},i.createElement(E.mc,{maxW:"800px",display:"flex",alignItems:"center",justifyContent:"center",mb:"6",className:"onboarding-block-footer"},this.nextButton))))}})||V;const te=(0,n.Ng)((({user:e})=>({clientTimestampDelta:(0,w.gE)(e),serverTimestamp:(0,w.mS)(e)})),{addMultipleFavoritesAction:_.jo})(ee),re=({...e})=>{var t;const r=e.context===Y.d.Improve?K.Dvu.IMPROVE:K.Dvu.WELCOME,[s]=(0,K.O7r)(),[a]=(0,K.BXP)(),{data:n,error:o,loading:l}=(0,K.V9d)({variables:{context:r}});if(o)throw o;if(l||!n)return null;const c=null===(t=n.onboardingSteps)||void 0===t?void 0:t.artistsPicker;return i.createElement(te,(0,u.A)({},e,{validateOnboardingArtistsPickerStep:e=>s({variables:{artistIds:e,context:r}}).then((()=>{})),addArtistsFavorites:e=>Promise.all(e.map((e=>a({variables:{artistId:e}})))).then((()=>{})),maxArtistsToSelect:(null==c?void 0:c.maximumArtistsToPick)||500,minArtistsToSelect:(null==c?void 0:c.minimumArtistsToPick)||0,showGenreFilter:!e.isOnlyAddArtist}))};var se,ie,ae,ne,oe,le,ce,de,he,me=r("9odk"),pe=r("6vRd"),ue=r("fkXJ");const fe=e=>i.createElement("svg",(0,u.A)({width:790,height:390,fill:"none",xmlns:"http://www.w3.org/2000/svg"},e),se||(se=i.createElement("g",{opacity:.3,filter:"url(#a)"},i.createElement("ellipse",{cx:212.021,cy:194.922,rx:111.021,ry:93.359,fill:"#C2FFD9"}))),ie||(ie=i.createElement("g",{opacity:.45,filter:"url(#b)"},i.createElement("ellipse",{cx:566.877,cy:194.922,rx:122.123,ry:93.359,fill:"url(#c)"}))),ae||(ae=i.createElement("g",{opacity:.5,filter:"url(#d)"},i.createElement("ellipse",{cx:513.796,cy:138.999,rx:36.334,ry:37.435,fill:"url(#e)"}))),ne||(ne=i.createElement("g",{filter:"url(#f)"},i.createElement("path",{d:"M260.474 200.043h87.456c6.207 0 1.552-11.034 10.862-11.034 9.309 0 3.103 28.372 13.964 28.372 10.862 0 7.758-40.982 17.068-40.982 9.31 0 3.103 23.644 10.861 23.644h79.843",stroke:"url(#g)",strokeWidth:8.074}))),oe||(oe=i.createElement("g",{filter:"url(#h)"},i.createElement("path",{d:"M299.456 197.3c0 51.437-41.698 93.135-93.135 93.135-51.437 0-93.134-41.698-93.134-93.135 0-51.437 41.697-93.134 93.134-93.134s93.135 41.697 93.135 93.134Z",fill:"url(#i)"}))),le||(le=i.createElement("g",{filter:"url(#j)",fill:"#fff"},i.createElement("rect",{x:212.782,y:169.287,width:17.058,height:67.646,rx:4.479,transform:"rotate(-18 212.782 169.287)"}),i.createElement("rect",{x:194.158,y:162.291,width:17.058,height:71.337,rx:4.723}),i.createElement("rect",{x:171.983,y:162.291,width:17.058,height:71.337,rx:4.723}))),ce||(ce=i.createElement("g",{filter:"url(#k)"},i.createElement("path",{d:"M662.689 197.3c0 51.437-41.698 93.135-93.134 93.135-51.437 0-93.135-41.698-93.135-93.135 0-51.437 41.698-93.134 93.135-93.134 51.436 0 93.134 41.697 93.134 93.134Z",fill:"url(#l)"}))),de||(de=i.createElement("g",{filter:"url(#m)"},i.createElement("path",{d:"M606.874 172.275h-15.786v8.622h15.786v-8.622Zm-42.097 12.933H548.99v8.622h15.787v-8.622Zm-15.787 12.933h15.787v8.622H548.99v-8.622Zm-5.262 12.932h-15.787v8.622h15.787v-8.622Zm21.049 0H548.99v8.622h15.787v-8.622Zm5.262 0h15.787v8.622h-15.787v-8.622Zm15.787-12.932h-15.787v8.622h15.787v-8.622Zm5.262 12.932h15.786v8.622h-15.786v-8.622Zm15.786-12.932h-15.786v8.622h15.786v-8.622Zm-15.786-12.933h15.786v8.622h-15.786v-8.622Z",fill:"#fff"}))),he||(he=i.createElement("defs",null,i.createElement("filter",{id:"a",x:.072,y:.635,width:423.898,height:388.573,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},i.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),i.createElement("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),i.createElement("feGaussianBlur",{stdDeviation:50.464,result:"effect1_foregroundBlur_2999_170083"})),i.createElement("filter",{id:"b",x:343.826,y:.635,width:446.102,height:388.573,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},i.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),i.createElement("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),i.createElement("feGaussianBlur",{stdDeviation:50.464,result:"effect1_foregroundBlur_2999_170083"})),i.createElement("filter",{id:"d",x:416.905,y:41.007,width:193.782,height:195.984,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},i.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),i.createElement("feBlend",{in:"SourceGraphic",in2:"BackgroundImageFix",result:"shape"}),i.createElement("feGaussianBlur",{stdDeviation:30.278,result:"effect1_foregroundBlur_2999_170083"})),i.createElement("filter",{id:"f",x:210.01,y:142.084,width:320.983,height:149.984,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},i.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),i.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),i.createElement("feOffset",{dy:20.186}),i.createElement("feGaussianBlur",{stdDeviation:25.232}),i.createElement("feComposite",{in2:"hardAlpha",operator:"out"}),i.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.3 0"}),i.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2999_170083"}),i.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2999_170083",result:"shape"})),i.createElement("filter",{id:"h",x:93.001,y:96.091,width:226.641,height:226.641,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},i.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),i.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),i.createElement("feOffset",{dy:12.111}),i.createElement("feGaussianBlur",{stdDeviation:10.093}),i.createElement("feComposite",{in2:"hardAlpha",operator:"out"}),i.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0"}),i.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2999_170083"}),i.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2999_170083",result:"shape"})),i.createElement("filter",{id:"j",x:145.919,y:150.562,width:128.889,height:123.464,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},i.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),i.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),i.createElement("feOffset",{dy:14.335}),i.createElement("feGaussianBlur",{stdDeviation:13.032}),i.createElement("feComposite",{in2:"hardAlpha",operator:"out"}),i.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0"}),i.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2999_170083"}),i.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2999_170083",result:"shape"})),i.createElement("filter",{id:"k",x:455.225,y:98.11,width:228.659,height:228.659,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},i.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),i.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),i.createElement("feOffset",{dy:15.139}),i.createElement("feGaussianBlur",{stdDeviation:10.598}),i.createElement("feComposite",{in2:"hardAlpha",operator:"out"}),i.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0"}),i.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2999_170083"}),i.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2999_170083",result:"shape"})),i.createElement("filter",{id:"m",x:507.756,y:163.192,width:119.305,height:87.791,filterUnits:"userSpaceOnUse",colorInterpolationFilters:"sRGB"},i.createElement("feFlood",{floodOpacity:0,result:"BackgroundImageFix"}),i.createElement("feColorMatrix",{in:"SourceAlpha",values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0",result:"hardAlpha"}),i.createElement("feOffset",{dy:11.102}),i.createElement("feGaussianBlur",{stdDeviation:10.093}),i.createElement("feComposite",{in2:"hardAlpha",operator:"out"}),i.createElement("feColorMatrix",{values:"0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.5 0"}),i.createElement("feBlend",{in2:"BackgroundImageFix",result:"effect1_dropShadow_2999_170083"}),i.createElement("feBlend",{in:"SourceGraphic",in2:"effect1_dropShadow_2999_170083",result:"shape"})),i.createElement("linearGradient",{id:"c",x1:557.319,y1:116.988,x2:575.878,y2:249.478,gradientUnits:"userSpaceOnUse"},i.createElement("stop",{stopColor:"#FFF500"}),i.createElement("stop",{offset:.912,stopColor:"#FD1987"})),i.createElement("linearGradient",{id:"e",x1:510.952,y1:107.748,x2:520.826,y2:160.053,gradientUnits:"userSpaceOnUse"},i.createElement("stop",{stopColor:"#FFFEEC"}),i.createElement("stop",{offset:.912,stopColor:"#FFF9FC"})),i.createElement("linearGradient",{id:"g",x1:222.744,y1:197.561,x2:546.935,y2:197.561,gradientUnits:"userSpaceOnUse"},i.createElement("stop",{stopColor:"#9CDA64"}),i.createElement("stop",{offset:.432,stopColor:"#47B477"}),i.createElement("stop",{offset:.894,stopColor:"#FA0A44"})),i.createElement("linearGradient",{id:"i",x1:113.187,y1:243.868,x2:299.456,y2:104.166,gradientUnits:"userSpaceOnUse"},i.createElement("stop",{stopColor:"#208C79"}),i.createElement("stop",{offset:1,stopColor:"#C3F25D"})),i.createElement("linearGradient",{id:"l",x1:504.626,y1:133.703,x2:637.144,y2:275.8,gradientUnits:"userSpaceOnUse"},i.createElement("stop",{stopColor:"#FF9A0F"}),i.createElement("stop",{offset:.27,stopColor:"#FF0A3C"}),i.createElement("stop",{offset:.518,stopColor:"#990BDC"}),i.createElement("stop",{offset:.885,stopColor:"#18A894"})))));var ge;const Ee=(0,a.Ay)({pagename:"onboarding-tmm",pagecategory:"onboarding-artists",virtualpageurl:"/onboarding-tmm",event:"virtualpageview"},{dispatchOnMount:!0})((({context:e,finishStep:t,tracking:r})=>{var s;const{data:a,loading:l,error:c}=(0,K.vjx)(),[h]=(0,K.weQ)(),[m,p]=(0,n.d4)((e=>[(0,w.F6)(e.user),(0,w.Mn)(e.user)]));if(c)throw c;if(l||!a||!a.onboardingSteps)return null;const u=e===Y.d.Welcome?K.Dvu.WELCOME:K.Dvu.IMPROVE;return i.createElement(E.so,{bgColor:"gray.100",flexDir:"column",position:"absolute",height:"100vh",width:"100%",top:0,left:0},i.createElement(d.A.Header,null,i.createElement(E.DZ,{as:"span"},a.onboardingSteps.importLibrary.title),i.createElement(E.EY,{fontSize:"md",fontWeight:400},(0,o.AP)("libraryimporteronboarding_text_transfermusiclibraryforfree_web")),i.createElement(E.EY,{fontSize:"md",fontWeight:400},(0,o.AP)("libraryimporteronboarding_text_fastsafethankstoXpartner_web",{sprintf:[a.onboardingSteps.importLibrary.importer]}))),i.createElement(E.az,{flexGrow:1},i.createElement(E.Tk,{alignItems:"center"},ge||(ge=i.createElement(fe,{height:"40vh"})),i.createElement(E.EY,{fontSize:"md",color:"gray.500"},(0,o.AP)("libraryimporteronboarding_text_supportsXstreamserviceslist_web",{sprintf:a.onboardingSteps.importLibrary.supportedServices})))),i.createElement(E.so,{gap:"2em",justifyContent:"center",padding:"6",bgColor:"white"},i.createElement(g.$n,{onClick:e=>{e.preventDefault(),null==r||r.trackEvent({eventname:"click",eventaction:"transfer-now",eventcategory:"onboarding-tmm"}),(async()=>{try{const e=await(0,pe.r)(m,p,!0);await h({variables:{context:u,hasSkipped:!1}}),open(e)}catch{(0,ue.A)({body:(0,o.AP)("Une erreur est survenue, merci de réessayer plus tard.")})}})()}},(0,o.AP)("libraryimporter_action_transfernow_web")),i.createElement(g.$n,{variant:"ghost",onClick:()=>{null==r||r.trackEvent({eventname:"click",eventaction:"skip",eventcategory:"onboarding-tmm"}),h({variables:{context:u,hasSkipped:!0}}).then(t)}},null===(s=a.onboardingSteps)||void 0===s?void 0:s.importLibrary.skipCTA)))})),Ae=({closeScreen:e,showCloseButton:t=!1,context:r=Y.d.Welcome,isOnlyAddArtist:s=!1,callbackLink:a="/"})=>{const n=(0,me.AP)(),o=(0,me.kA)(),[l,c]=i.useState(!1);if(!n||o.loading)return null;let d=s||r===Y.d.Improve?"artistsPicker":n.currentStep;l&&(d="finish");let h=null;switch(d){case"artistsPicker":h=i.createElement(re,{context:r,finishStep:()=>{o.refetch(),c(!0)},isOnlyAddArtist:s,showCloseButton:t,closeScreen:e});break;case"importLibrary":h=i.createElement(Ee,{context:r,finishStep:o.refetch});break;default:h=i.createElement(p,{closeScreen:e,callbackLink:a})}return i.createElement(i.Fragment,null,h)}},"6vRd":(e,t,r)=>{r.d(t,{K:()=>c,r:()=>l}),r("/eM8"),r("EV0h"),r("gS5K");var s=r("nrKQ"),i=r("Vd8Q"),a=r("Wp0Y"),n=r("fkXJ");const o=`//${i.default.get("host_website_ssl")}/profile/me`,l=async(e,t,r)=>{const i=await s.A.callAsync({method:"libraryimport.getTMMAccessToken",data:{}}).catch((e=>{throw e})),a=await fetch("https://www.tunemymusic.com/api/AuthenticateUser.php",{method:"POST",cache:"default",body:JSON.stringify({deezer_access_token:i,deezer_user_id:e,deezer_user_name:t,deezer_redirect_url:r?"deezer://reload":o})}).catch((e=>{throw e}));if(!a.ok||200!==a.status)throw new Error("TMM: response error");const n=await a.json().catch((e=>{throw e}));try{const e=new URL(n.migration_url);return e.searchParams.append("mode","deezer"),e.href}catch(e){throw new Error("TMM: migration url not valid")}},c=()=>{(0,n.A)({body:(0,a.AP)("libraryimporterdismiss_text_transferstillavailableinsettings_web")}),s.A.callAsync({method:"libraryimport.flagTMMAsDismissed"}).catch((e=>{throw e}))}},MG7B:(e,t,r)=>{function s(e){const t=document.createElement("div");return t.textContent=e,t.innerHTML}r.d(t,{A:()=>s})}}]);